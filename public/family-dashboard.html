<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Family Dashboard - MathsMayhem</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Comic Sans MS', cursive, sans-serif;
            margin: 0;
            padding: 20px 0;
            color: #333;
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }
        
        .nav-bar {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .nav-links {
            display: flex;
            gap: 20px;
        }
        
        .nav-link {
            background: linear-gradient(90deg, #4a90e2, #667eea);
            color: white;
            padding: 10px 20px;
            border-radius: 10px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .nav-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(74,144,226,0.3);
        }
        
        .nav-link.active {
            background: linear-gradient(90deg, #ff6b6b, #fcb045);
        }
        
        .family-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .overview-card {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .overview-card h3 {
            color: #4a90e2;
            font-size: 1.8rem;
            margin-bottom: 15px;
        }
        
        .overview-stat {
            font-size: 2.5rem;
            font-weight: bold;
            color: #ff6b6b;
            margin-bottom: 10px;
        }
        
        .family-members {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .family-members h2 {
            color: #4a90e2;
            font-size: 2rem;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .members-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }
        
        .member-card {
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            border-radius: 15px;
            padding: 20px;
            position: relative;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }
        
        .member-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .member-card.admin {
            border-color: #ff6b6b;
        }
        
        .member-card.child {
            border-color: #4a90e2;
        }
        
        .member-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            margin: 0 auto 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: white;
        }
        
        .member-avatar.admin {
            background: linear-gradient(135deg, #ff6b6b, #fcb045);
        }
        
        .member-avatar.child {
            background: linear-gradient(135deg, #4a90e2, #667eea);
        }
        
        .member-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #333;
            text-align: center;
            margin-bottom: 10px;
        }
        
        .member-role {
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .member-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 8px;
            background: rgba(255,255,255,0.8);
            border-radius: 8px;
        }
        
        .stat-value {
            font-size: 1.2rem;
            font-weight: bold;
            color: #4a90e2;
        }
        
        .stat-label {
            font-size: 0.8rem;
            color: #666;
        }
        
        .member-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
        }
        
        .action-btn {
            padding: 8px 15px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: bold;
        }
        
        .view-btn {
            background: #4a90e2;
            color: white;
        }
        
        .view-btn:hover {
            background: #667eea;
        }
        
        .edit-btn {
            background: #fcb045;
            color: white;
        }
        
        .edit-btn:hover {
            background: #ff6b6b;
        }
        
        .add-member-card {
            background: linear-gradient(145deg, #f0f9ff, #e0f2fe);
            border: 2px dashed #4a90e2;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .add-member-card:hover {
            transform: translateY(-3px);
            border-color: #667eea;
        }
        
        .add-icon {
            font-size: 3rem;
            color: #4a90e2;
            margin-bottom: 15px;
        }
        
        .add-text {
            font-size: 1.2rem;
            color: #4a90e2;
            font-weight: bold;
        }
        
        .progress-section {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .progress-section h2 {
            color: #4a90e2;
            font-size: 2rem;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .weekly-report {
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
        }
        
        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .report-title {
            font-size: 1.5rem;
            color: #333;
            font-weight: bold;
        }
        
        .report-date {
            color: #666;
            font-size: 1rem;
        }
        
        .progress-chart {
            height: 200px;
            background: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            border: 2px solid #e2e8f0;
        }
        
        .chart-placeholder {
            color: #666;
            font-size: 1.1rem;
            text-align: center;
        }
        
        .achievement-highlights {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .achievement-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            border: 1px solid #e2e8f0;
        }
        
        .achievement-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }
        
        .achievement-text {
            font-size: 0.9rem;
            color: #666;
        }
        
        .parental-controls {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .parental-controls h2 {
            color: #4a90e2;
            font-size: 2rem;
            margin-bottom: 25px;
            text-align: center;
        }
        
        .controls-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }
        
        .control-section {
            background: linear-gradient(145deg, #f8fafc, #e2e8f0);
            border-radius: 15px;
            padding: 20px;
        }
        
        .control-title {
            font-size: 1.3rem;
            color: #333;
            font-weight: bold;
            margin-bottom: 15px;
        }
        
        .control-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .control-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .control-label {
            font-size: 1rem;
            color: #555;
        }
        
        .toggle-switch {
            position: relative;
            width: 60px;
            height: 30px;
            background: #ccc;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .toggle-switch.active {
            background: #4a90e2;
        }
        
        .toggle-slider {
            position: absolute;
            top: 3px;
            left: 3px;
            width: 24px;
            height: 24px;
            background: white;
            border-radius: 50%;
            transition: all 0.3s ease;
        }
        
        .toggle-switch.active .toggle-slider {
            transform: translateX(30px);
        }
        
        .time-input {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .time-input input {
            padding: 8px 12px;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            font-size: 1rem;
            width: 80px;
        }
        
        .back-btn {
            display: inline-block;
            background: rgba(255,255,255,0.9);
            color: #4a90e2;
            padding: 12px 25px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        @media (max-width: 768px) {
            .nav-links {
                flex-direction: column;
                gap: 10px;
            }
            
            .family-overview {
                grid-template-columns: 1fr;
            }
            
            .controls-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 500px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }
        
        .modal-header {
            font-size: 1.8rem;
            color: #4a90e2;
            margin-bottom: 20px;
            text-align: center;
            font-weight: bold;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #333;
            font-weight: bold;
        }
        
        .form-group input,
        .form-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
        }
        
        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #4a90e2;
        }
        
        .modal-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 25px;
        }
        
        .modal-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .save-btn {
            background: #4a90e2;
            color: white;
        }
        
        .save-btn:hover {
            background: #667eea;
        }
        
        .cancel-btn {
            background: #e2e8f0;
            color: #666;
        }
        
        .cancel-btn:hover {
            background: #cbd5e1;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            line-height: 1;
        }
        
        .close:hover {
            color: #333;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <a href="index.html" class="back-btn">üè† Back to Home</a>
        
        <div class="header">
            <h1>üë®‚Äçüë©‚Äçüëß‚Äçüë¶ Family Dashboard</h1>
            <p style="font-size: 1.2rem; margin-top: 10px;">Manage your family's learning journey together!</p>
        </div>
        
        <div class="nav-bar">
            <div class="nav-links">
                <a href="#overview" class="nav-link active" onclick="showSection('overview')">üìä Overview</a>
                <a href="#members" class="nav-link" onclick="showSection('members')">üë• Members</a>
                <a href="#progress" class="nav-link" onclick="showSection('progress')">üìà Progress</a>
                <a href="#controls" class="nav-link" onclick="showSection('controls')">üîí Controls</a>
                <a href="#reports" class="nav-link" onclick="showSection('reports')">üìã Reports</a>
            </div>
            <div style="color: #4a90e2; font-weight: bold;">
                Family Plan Active ‚ú®
            </div>
        </div>
        
        <!-- Overview Section -->
        <div id="overview-section" class="section">
            <div class="family-overview">
                <div class="overview-card">
                    <h3>üë• Family Members</h3>
                    <div class="overview-stat" id="total-members">3</div>
                    <p>Active Learners</p>
                </div>
                
                <div class="overview-card">
                    <h3>üéØ Total Quizzes</h3>
                    <div class="overview-stat" id="total-quizzes">247</div>
                    <p>This Week</p>
                </div>
                
                <div class="overview-card">
                    <h3>‚≠ê Achievements</h3>
                    <div class="overview-stat" id="total-achievements">18</div>
                    <p>Earned This Month</p>
                </div>
                
                <div class="overview-card">
                    <h3>üìö Study Time</h3>
                    <div class="overview-stat" id="study-time">12.5</div>
                    <p>Hours This Week</p>
                </div>
            </div>
        </div>
        
        <!-- Members Section -->
        <div id="members-section" class="section" style="display: none;">
            <div class="family-members">
                <h2>Family Members (3/6)</h2>
                <div class="members-grid" id="members-grid">
                    <!-- Members will be populated by JavaScript -->
                </div>
            </div>
        </div>
        
        <!-- Progress Section -->
        <div id="progress-section" class="section" style="display: none;">
            <div class="progress-section">
                <h2>üìà Family Progress Overview</h2>
                
                <div class="weekly-report">
                    <div class="report-header">
                        <div class="report-title">Weekly Family Report</div>
                        <div class="report-date">Week of Aug 4-10, 2025</div>
                    </div>
                    
                    <div class="progress-chart">
                        <div class="chart-placeholder">
                            üìä Interactive progress charts coming soon!<br>
                            <small>Track daily quiz completion, accuracy rates, and learning streaks</small>
                        </div>
                    </div>
                    
                    <div class="achievement-highlights">
                        <div class="achievement-item">
                            <div class="achievement-icon">üèÜ</div>
                            <div class="achievement-text">Emma completed her 50th quiz!</div>
                        </div>
                        <div class="achievement-item">
                            <div class="achievement-icon">üéØ</div>
                            <div class="achievement-text">Jake improved accuracy by 15%</div>
                        </div>
                        <div class="achievement-item">
                            <div class="achievement-icon">üî•</div>
                            <div class="achievement-text">Family maintained 7-day streak</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Controls Section -->
        <div id="controls-section" class="section" style="display: none;">
            <div class="parental-controls">
                <h2>üîí Parental Controls</h2>
                
                <div class="controls-grid">
                    <div class="control-section">
                        <div class="control-title">Time Management</div>
                        
                        <div class="control-item">
                            <div class="control-label">Enable Daily Time Limits</div>
                            <div class="toggle-switch active" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Max Daily Screen Time</div>
                            <div class="time-input">
                                <input type="number" value="60" min="15" max="300"> minutes
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Quiet Hours (No Notifications)</div>
                            <div class="time-input">
                                <input type="time" value="21:00"> to <input type="time" value="07:00">
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-section">
                        <div class="control-title">Content Filtering</div>
                        
                        <div class="control-item">
                            <div class="control-label">Age-Appropriate Content Only</div>
                            <div class="toggle-switch active" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Block Advanced Topics</div>
                            <div class="toggle-switch" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Require Parent Approval for New Topics</div>
                            <div class="toggle-switch active" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-section">
                        <div class="control-title">Learning Goals</div>
                        
                        <div class="control-item">
                            <div class="control-label">Daily Quiz Goal</div>
                            <div class="time-input">
                                <input type="number" value="5" min="1" max="20"> quizzes
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Weekly Accuracy Target</div>
                            <div class="time-input">
                                <input type="number" value="80" min="50" max="100">%
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Send Progress Reminders</div>
                            <div class="toggle-switch active" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="control-section">
                        <div class="control-title">Privacy & Safety</div>
                        
                        <div class="control-item">
                            <div class="control-label">Share Progress with Teachers</div>
                            <div class="toggle-switch" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Enable Leaderboards</div>
                            <div class="toggle-switch active" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                        
                        <div class="control-item">
                            <div class="control-label">Data Export Available</div>
                            <div class="toggle-switch active" onclick="toggleSwitch(this)">
                                <div class="toggle-slider"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Reports Section -->
        <div id="reports-section" class="section" style="display: none;">
            <div class="progress-section">
                <h2>üìã Detailed Reports</h2>
                
                <div class="weekly-report">
                    <div class="report-header">
                        <div class="report-title">üí° Educational Tips for Parents</div>
                        <div class="report-date">Updated Weekly</div>
                    </div>
                    
                    <div style="background: white; border-radius: 10px; padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: #4a90e2; margin-bottom: 15px;">üìö This Week's Math Tips</h3>
                        <ul style="line-height: 1.6; color: #555;">
                            <li><strong>Fraction Practice:</strong> Use pizza slices or cake pieces to visualize fractions during snack time!</li>
                            <li><strong>Times Tables:</strong> Create a song or rhyme for the 7x table - it's often the trickiest one.</li>
                            <li><strong>Word Problems:</strong> Encourage your child to draw pictures for word problems to better understand what's being asked.</li>
                            <li><strong>Positive Reinforcement:</strong> Celebrate effort over results - "You worked really hard on that problem!" vs "You're so smart!"</li>
                        </ul>
                    </div>
                    
                    <div style="background: white; border-radius: 10px; padding: 20px;">
                        <h3 style="color: #4a90e2; margin-bottom: 15px;">üìä Weekly Report Summary</h3>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                            <div style="text-align: center; padding: 15px; background: #f8fafc; border-radius: 10px;">
                                <div style="font-size: 2rem; color: #4a90e2; font-weight: bold;">92%</div>
                                <div style="color: #666;">Average Family Accuracy</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f8fafc; border-radius: 10px;">
                                <div style="font-size: 2rem; color: #10c168; font-weight: bold;">67</div>
                                <div style="color: #666;">Quizzes Completed</div>
                            </div>
                            <div style="text-align: center; padding: 15px; background: #f8fafc; border-radius: 10px;">
                                <div style="font-size: 2rem; color: #fcb045; font-weight: bold;">8.2</div>
                                <div style="color: #666;">Hours Studied</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Member Modal -->
    <div id="addMemberModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div class="modal-header">Add New Family Member</div>
            
            <div class="form-group">
                <label for="memberName">Name</label>
                <input type="text" id="memberName" placeholder="Enter name">
            </div>
            
            <div class="form-group">
                <label for="memberAge">Age</label>
                <input type="number" id="memberAge" placeholder="Enter age" min="4" max="18">
            </div>
            
            <div class="form-group">
                <label for="memberRole">Role</label>
                <select id="memberRole">
                    <option value="child">Child</option>
                    <option value="teen">Teenager</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="memberAvatar">Avatar</label>
                <select id="memberAvatar">
                    <option value="üë¶">üë¶ Boy</option>
                    <option value="üëß">üëß Girl</option>
                    <option value="üßí">üßí Child</option>
                    <option value="üë®‚Äçüéì">üë®‚Äçüéì Student</option>
                    <option value="üë©‚Äçüéì">üë©‚Äçüéì Student</option>
                </select>
            </div>
            
            <div class="modal-actions">
                <button class="modal-btn save-btn" onclick="addFamilyMember()">Add Member</button>
                <button class="modal-btn cancel-btn" onclick="closeModal()">Cancel</button>
            </div>
        </div>
    </div>
    
    <script>
        // Family data storage
        let familyData = {
            members: [
                {
                    id: 1,
                    name: "Parent (You)",
                    role: "Parent",
                    avatar: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶",
                    quizzesToday: 0,
                    accuracy: 0,
                    streak: 0,
                    totalQuizzes: 0,
                    isAdmin: true
                },
                {
                    id: 2,
                    name: "Emma",
                    role: "Age 8",
                    avatar: "üëß",
                    quizzesToday: 7,
                    accuracy: 94,
                    streak: 12,
                    totalQuizzes: 156,
                    isAdmin: false
                },
                {
                    id: 3,
                    name: "Jake",
                    role: "Age 11",
                    avatar: "üë¶",
                    quizzesToday: 5,
                    accuracy: 87,
                    streak: 8,
                    totalQuizzes: 203,
                    isAdmin: false
                }
            ],
            settings: {
                dailyTimeLimit: true,
                maxDailyTime: 60,
                quietHoursStart: "21:00",
                quietHoursEnd: "07:00",
                ageAppropriate: true,
                blockAdvanced: false,
                requireApproval: true,
                dailyQuizGoal: 5,
                weeklyAccuracyTarget: 80,
                progressReminders: true,
                shareWithTeachers: false,
                enableLeaderboards: true,
                dataExport: true
            }
        };
        
        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user has family plan
            const subscriptionPlan = localStorage.getItem('subscriptionPlan');
            if (subscriptionPlan !== 'family' && subscriptionPlan !== 'genius' && subscriptionPlan !== 'tutor') {
                alert('üîí Family Dashboard is only available for Family Plan subscribers!\n\nPlease upgrade your subscription to access this feature.');
                window.location.href = 'subscription.html';
                return;
            }
            
            loadFamilyData();
            renderMembers();
            updateOverviewStats();
        });
        
        function loadFamilyData() {
            // Load family data from localStorage if exists
            const savedData = localStorage.getItem('familyData');
            if (savedData) {
                familyData = JSON.parse(savedData);
            } else {
                // Save default data
                localStorage.setItem('familyData', JSON.stringify(familyData));
            }
        }
        
        function saveFamilyData() {
            localStorage.setItem('familyData', JSON.stringify(familyData));
        }
        
        function renderMembers() {
            const membersGrid = document.getElementById('members-grid');
            membersGrid.innerHTML = '';
            
            // Render existing members
            familyData.members.forEach(member => {
                const memberCard = document.createElement('div');
                memberCard.className = `member-card ${member.isAdmin ? 'admin' : 'child'}`;
                
                memberCard.innerHTML = `
                    <div class="member-avatar ${member.isAdmin ? 'admin' : 'child'}">
                        ${member.avatar}
                    </div>
                    <div class="member-name">${member.name}</div>
                    <div class="member-role">${member.role}</div>
                    <div class="member-stats">
                        <div class="stat-item">
                            <div class="stat-value">${member.quizzesToday}</div>
                            <div class="stat-label">Today</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${member.accuracy}%</div>
                            <div class="stat-label">Accuracy</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${member.streak}</div>
                            <div class="stat-label">Streak</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value">${member.totalQuizzes}</div>
                            <div class="stat-label">Total</div>
                        </div>
                    </div>
                    <div class="member-actions">
                        <button class="action-btn view-btn" onclick="viewMemberDetails(${member.id})">üëÄ View</button>
                        ${!member.isAdmin ? `<button class="action-btn edit-btn" onclick="editMember(${member.id})">‚úèÔ∏è Edit</button>` : ''}
                    </div>
                `;
                
                membersGrid.appendChild(memberCard);
            });
            
            // Add "Add Member" card if under limit
            if (familyData.members.length < 6) {
                const addCard = document.createElement('div');
                addCard.className = 'add-member-card';
                addCard.onclick = () => openAddMemberModal();
                
                addCard.innerHTML = `
                    <div class="add-icon">‚ûï</div>
                    <div class="add-text">Add Family Member</div>
                    <div style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                        ${6 - familyData.members.length} slots remaining
                    </div>
                `;
                
                membersGrid.appendChild(addCard);
            }
        }
        
        function updateOverviewStats() {
            document.getElementById('total-members').textContent = familyData.members.length;
            
            const totalQuizzes = familyData.members.reduce((sum, member) => sum + member.quizzesToday, 0);
            document.getElementById('total-quizzes').textContent = totalQuizzes;
            
            // Calculate total achievements (mock data)
            document.getElementById('total-achievements').textContent = Math.floor(totalQuizzes * 0.3);
            
            // Calculate study time (mock calculation: 3 minutes per quiz)
            const studyHours = (totalQuizzes * 3 / 60).toFixed(1);
            document.getElementById('study-time').textContent = studyHours;
        }
        
        function showSection(sectionName) {
            // Hide all sections
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => section.style.display = 'none');
            
            // Show selected section
            document.getElementById(sectionName + '-section').style.display = 'block';
            
            // Update active nav link
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        function toggleSwitch(element) {
            element.classList.toggle('active');
            // Here you would save the setting to familyData.settings
            saveFamilyData();
        }
        
        function openAddMemberModal() {
            document.getElementById('addMemberModal').style.display = 'block';
        }
        
        function closeModal() {
            document.getElementById('addMemberModal').style.display = 'none';
            // Clear form
            document.getElementById('memberName').value = '';
            document.getElementById('memberAge').value = '';
            document.getElementById('memberRole').value = 'child';
            document.getElementById('memberAvatar').value = 'üë¶';
        }
        
        function addFamilyMember() {
            const name = document.getElementById('memberName').value;
            const age = document.getElementById('memberAge').value;
            const role = document.getElementById('memberRole').value;
            const avatar = document.getElementById('memberAvatar').value;
            
            if (!name || !age) {
                alert('Please fill in all required fields!');
                return;
            }
            
            if (familyData.members.length >= 6) {
                alert('Maximum family size reached (6 members)');
                return;
            }
            
            const newMember = {
                id: Date.now(),
                name: name,
                role: `Age ${age}`,
                avatar: avatar,
                quizzesToday: 0,
                accuracy: 0,
                streak: 0,
                totalQuizzes: 0,
                isAdmin: false
            };
            
            familyData.members.push(newMember);
            saveFamilyData();
            renderMembers();
            updateOverviewStats();
            closeModal();
            
            alert(`‚úÖ ${name} has been added to your family! They can now log in and start learning.`);
        }
        
        function viewMemberDetails(memberId) {
            const member = familyData.members.find(m => m.id === memberId);
            if (member) {
                alert(`üìä ${member.name}'s Details:\n\n` +
                      `‚Ä¢ Quizzes Today: ${member.quizzesToday}\n` +
                      `‚Ä¢ Accuracy Rate: ${member.accuracy}%\n` +
                      `‚Ä¢ Current Streak: ${member.streak} days\n` +
                      `‚Ä¢ Total Quizzes: ${member.totalQuizzes}\n\n` +
                      `Detailed analytics and progress charts coming soon!`);
            }
        }
        
        function editMember(memberId) {
            const member = familyData.members.find(m => m.id === memberId);
            if (member) {
                const newName = prompt(`Edit name for ${member.name}:`, member.name);
                if (newName && newName.trim()) {
                    member.name = newName.trim();
                    saveFamilyData();
                    renderMembers();
                }
            }
        }
        
        // Close modal when clicking outside
        window.onclick = function(event) {
            const modal = document.getElementById('addMemberModal');
            if (event.target === modal) {
                closeModal();
            }
        }
    </script>
</body>
</html>
