<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Homework Helper - MathsMayhem</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            color: #333;
        }
        
        .homework-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
            color: white;
        }
        
        .header h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            text-shadow: 0 3px 15px rgba(0,0,0,0.3);
        }
        
        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .back-btn {
            display: inline-block;
            background: rgba(255,255,255,0.9);
            color: #667eea;
            padding: 12px 25px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
            margin-bottom: 30px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .back-btn:hover {
            background: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
        }
        
        .main-grid {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .homework-input-section {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .input-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
        }
        
        .input-title i {
            margin-right: 10px;
            color: #667eea;
        }
        
        .input-methods {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .method-btn {
            flex: 1;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .method-btn:hover,
        .method-btn.active {
            border-color: #667eea;
            background: #f8fafc;
            color: #667eea;
        }
        
        .input-area {
            margin-bottom: 20px;
        }
        
        .problem-input {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 15px;
            font-size: 1rem;
            resize: vertical;
            transition: border-color 0.3s ease;
        }
        
        .problem-input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .file-upload {
            display: none;
        }
        
        .upload-area {
            border: 2px dashed #e0e0e0;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover,
        .upload-area.dragover {
            border-color: #667eea;
            background: #f8fafc;
        }
        
        .upload-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .difficulty-selector {
            margin-bottom: 20px;
        }
        
        .difficulty-label {
            font-weight: 500;
            margin-bottom: 10px;
            color: #333;
        }
        
        .difficulty-options {
            display: flex;
            gap: 10px;
        }
        
        .difficulty-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .difficulty-easy {
            background: #e8f5e8;
            color: #4caf50;
        }
        
        .difficulty-medium {
            background: #fff3e0;
            color: #ff9800;
        }
        
        .difficulty-hard {
            background: #ffeaea;
            color: #f44336;
        }
        
        .difficulty-btn.active {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .solve-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }
        
        .solve-btn:hover {
            background: linear-gradient(90deg, #764ba2, #667eea);
            transform: translateY(-2px);
        }
        
        .solve-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .stats-sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .stat-widget {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .stat-icon {
            font-size: 2.5rem;
            margin-bottom: 15px;
            color: #667eea;
        }
        
        .stat-number {
            font-size: 2rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        
        .stat-label {
            color: #666;
            font-size: 0.9rem;
        }
        
        .solution-section {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            display: none;
        }
        
        .solution-header {
            display: flex;
            justify-content: between;
            align-items: center;
            margin-bottom: 25px;
        }
        
        .solution-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
        }
        
        .solution-steps {
            margin-bottom: 25px;
        }
        
        .step {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #667eea;
        }
        
        .step-number {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
        }
        
        .step-content {
            color: #333;
            line-height: 1.6;
        }
        
        .solution-explanation {
            background: #e8f5e8;
            border-radius: 15px;
            padding: 20px;
            border-left: 4px solid #4caf50;
        }
        
        .explanation-title {
            font-weight: bold;
            color: #2e7d2e;
            margin-bottom: 10px;
        }
        
        .explanation-content {
            color: #2e7d2e;
            line-height: 1.6;
        }
        
        .recent-problems {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .recent-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
        }
        
        .problem-item {
            background: #f8fafc;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .problem-item:hover {
            background: #e2e8f0;
            transform: translateX(5px);
        }
        
        .problem-preview {
            flex: 1;
            color: #333;
            font-weight: 500;
        }
        
        .problem-difficulty {
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            display: none;
        }
        
        .loading-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 400px;
        }
        
        .loading-spinner {
            font-size: 3rem;
            color: #667eea;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .math-formula {
            font-family: 'Times New Roman', serif;
            font-style: italic;
            background: #f0f4f8;
            padding: 10px 15px;
            border-radius: 10px;
            display: inline-block;
            margin: 5px 0;
        }
        
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .input-methods {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="homework-container">
        <a href="index.html" class="back-btn"><i class="fas fa-arrow-left"></i> Back to Dashboard</a>
        
        <div class="header">
            <h1>üßÆ AI Homework Helper</h1>
            <p>Get step-by-step solutions and explanations for any math problem</p>
        </div>
        
        <div class="main-grid">
            <!-- Main Input Section -->
            <div class="homework-input-section">
                <div class="input-title">
                    <i class="fas fa-edit"></i>
                    Enter Your Math Problem
                </div>
                
                <!-- Input Methods -->
                <div class="input-methods">
                    <div class="method-btn active" onclick="setInputMethod('text')">
                        <i class="fas fa-keyboard"></i><br>Type Problem
                    </div>
                    <div class="method-btn" onclick="setInputMethod('upload')">
                        <i class="fas fa-camera"></i><br>Upload Image
                    </div>
                    <div class="method-btn" onclick="setInputMethod('photo')">
                        <i class="fas fa-mobile-alt"></i><br>Take Photo
                    </div>
                </div>
                
                <!-- Text Input -->
                <div class="input-area" id="textInput">
                    <textarea 
                        class="problem-input" 
                        placeholder="Enter your math problem here... 

Examples:
‚Ä¢ Solve: 2x + 5 = 13
‚Ä¢ Find the derivative of f(x) = 3x¬≤ + 2x - 1
‚Ä¢ Calculate the area of a circle with radius 5 cm
‚Ä¢ Simplify: (x¬≤ - 4)/(x - 2)"
                        id="problemText"></textarea>
                </div>
                
                <!-- Upload Input -->
                <div class="input-area" id="uploadInput" style="display: none;">
                    <input type="file" id="fileUpload" class="file-upload" accept="image/*" onchange="handleFileUpload(event)">
                    <div class="upload-area" onclick="document.getElementById('fileUpload').click()">
                        <div class="upload-icon"><i class="fas fa-cloud-upload-alt"></i></div>
                        <div><strong>Click to upload</strong> or drag and drop</div>
                        <div style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                            Supports: JPG, PNG, HEIC, WebP
                        </div>
                    </div>
                </div>
                
                <!-- Difficulty Selector -->
                <div class="difficulty-selector">
                    <div class="difficulty-label">Problem Difficulty:</div>
                    <div class="difficulty-options">
                        <button class="difficulty-btn difficulty-easy active" onclick="setDifficulty('easy')">Easy</button>
                        <button class="difficulty-btn difficulty-medium" onclick="setDifficulty('medium')">Medium</button>
                        <button class="difficulty-btn difficulty-hard" onclick="setDifficulty('hard')">Hard</button>
                    </div>
                </div>
                
                <!-- Solve Button -->
                <button class="solve-btn" onclick="solveProblem()">
                    <i class="fas fa-magic"></i> Solve Problem
                </button>
                
                <!-- Quick Examples -->
                <div style="margin-top: 20px;">
                    <div style="font-weight: 500; margin-bottom: 10px; color: #333;">Quick Examples:</div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <button onclick="loadExample('algebra')" class="difficulty-btn difficulty-easy">
                            Algebra
                        </button>
                        <button onclick="loadExample('geometry')" class="difficulty-btn difficulty-medium">
                            Geometry  
                        </button>
                        <button onclick="loadExample('calculus')" class="difficulty-btn difficulty-hard">
                            Calculus
                        </button>
                        <button onclick="loadExample('statistics')" class="difficulty-btn difficulty-easy">
                            Statistics
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Stats Sidebar -->
            <div class="stats-sidebar">
                <div class="stat-widget">
                    <div class="stat-icon"><i class="fas fa-check-circle"></i></div>
                    <div class="stat-number" id="problemsSolved">47</div>
                    <div class="stat-label">Problems Solved</div>
                </div>
                
                <div class="stat-widget">
                    <div class="stat-icon"><i class="fas fa-clock"></i></div>
                    <div class="stat-number" id="avgSolveTime">2.3min</div>
                    <div class="stat-label">Average Solve Time</div>
                </div>
                
                <div class="stat-widget">
                    <div class="stat-icon"><i class="fas fa-star"></i></div>
                    <div class="stat-number" id="helpfulRating">4.8/5</div>
                    <div class="stat-label">Helpfulness Rating</div>
                </div>
                
                <div class="stat-widget">
                    <div class="stat-icon"><i class="fas fa-fire"></i></div>
                    <div class="stat-number" id="streak">12</div>
                    <div class="stat-label">Day Streak</div>
                </div>
            </div>
        </div>
        
        <!-- Solution Section -->
        <div class="solution-section" id="solutionSection">
            <div class="solution-header">
                <div class="solution-title">
                    <i class="fas fa-lightbulb" style="color: #f39c12; margin-right: 10px;"></i>
                    Solution & Explanation
                </div>
            </div>
            
            <div class="solution-steps" id="solutionSteps">
                <!-- Steps will be populated by JavaScript -->
            </div>
            
            <div class="solution-explanation">
                <div class="explanation-title">
                    <i class="fas fa-brain" style="margin-right: 8px;"></i>
                    Why This Works
                </div>
                <div class="explanation-content" id="explanationContent">
                    <!-- Explanation will be populated by JavaScript -->
                </div>
            </div>
            
            <div style="margin-top: 25px; text-align: center;">
                <button class="difficulty-btn difficulty-easy" onclick="rateSolution('helpful')">
                    üëç Helpful
                </button>
                <button class="difficulty-btn difficulty-medium" onclick="rateSolution('confusing')">
                    ü§î Confusing
                </button>
                <button class="difficulty-btn difficulty-hard" onclick="getMoreHelp()">
                    üÜò Need More Help
                </button>
            </div>
        </div>
        
        <!-- Recent Problems -->
        <div class="recent-problems">
            <div class="recent-title">
                <i class="fas fa-history" style="color: #667eea; margin-right: 10px;"></i>
                Recent Problems
            </div>
            
            <div class="problem-item" onclick="loadRecentProblem('quadratic')">
                <div class="problem-preview">Solve: x¬≤ - 5x + 6 = 0</div>
                <div class="problem-difficulty difficulty-medium">Medium</div>
            </div>
            
            <div class="problem-item" onclick="loadRecentProblem('derivative')">
                <div class="problem-preview">Find derivative of f(x) = sin(x) + cos(x)</div>
                <div class="problem-difficulty difficulty-hard">Hard</div>
            </div>
            
            <div class="problem-item" onclick="loadRecentProblem('geometry')">
                <div class="problem-preview">Area of triangle with sides 3, 4, 5</div>
                <div class="problem-difficulty difficulty-easy">Easy</div>
            </div>
            
            <div class="problem-item" onclick="loadRecentProblem('statistics')">
                <div class="problem-preview">Mean and standard deviation of dataset</div>
                <div class="problem-difficulty difficulty-medium">Medium</div>
            </div>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"><i class="fas fa-cog"></i></div>
            <div style="font-size: 1.2rem; font-weight: bold; margin-bottom: 10px;">
                Solving Your Problem...
            </div>
            <div style="color: #666;">
                AI is analyzing and generating step-by-step solution
            </div>
        </div>
    </div>
    
    <script src="data-migration.js"></script>
    <script src="user-manager.js"></script>
    <script>
        let currentInputMethod = 'text';
        let currentDifficulty = 'easy';
        
        // Input method switching
        function setInputMethod(method) {
            currentInputMethod = method;
            
            // Update active button
            document.querySelectorAll('.method-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Show/hide input areas
            document.getElementById('textInput').style.display = method === 'text' ? 'block' : 'none';
            document.getElementById('uploadInput').style.display = method === 'upload' || method === 'photo' ? 'block' : 'none';
            
            if (method === 'photo') {
                // Mobile photo capture
                const fileInput = document.getElementById('fileUpload');
                fileInput.setAttribute('capture', 'camera');
            }
        }
        
        // Difficulty setting
        function setDifficulty(difficulty) {
            currentDifficulty = difficulty;
            
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                if (btn.textContent.toLowerCase().includes(difficulty)) {
                    btn.classList.add('active');
                } else {
                    btn.classList.remove('active');
                }
            });
        }
        
        // File upload handling
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const uploadArea = document.querySelector('.upload-area');
                    uploadArea.innerHTML = `
                        <div class="upload-icon"><i class="fas fa-check-circle" style="color: #4caf50;"></i></div>
                        <div><strong>Image uploaded successfully!</strong></div>
                        <div style="color: #666; font-size: 0.9rem; margin-top: 10px;">
                            ${file.name}
                        </div>
                        <img src="${e.target.result}" style="max-width: 200px; margin-top: 15px; border-radius: 10px;">
                    `;
                };
                reader.readAsDataURL(file);
            }
        }
        
        // Drag and drop functionality
        const uploadArea = document.querySelector('.upload-area');
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('dragover');
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileUpload({ target: { files: files } });
            }
        });
        
        // Problem examples
        function loadExample(type) {
            const examples = {
                algebra: "Solve for x: 3x + 7 = 2x - 5",
                geometry: "Find the area of a circle with diameter 10 cm",
                calculus: "Find the derivative of f(x) = x¬≥ + 2x¬≤ - 5x + 1",
                statistics: "Calculate the mean of: 12, 15, 18, 22, 25, 28"
            };
            
            document.getElementById('problemText').value = examples[type];
            setInputMethod('text');
        }
        
        // Main solve function
        function solveProblem() {
            const problemText = document.getElementById('problemText').value.trim();
            const fileUpload = document.getElementById('fileUpload').files[0];
            
            if (!problemText && !fileUpload) {
                alert('Please enter a problem or upload an image!');
                return;
            }
            
            // Show loading
            document.getElementById('loadingOverlay').style.display = 'flex';
            
            // Simulate AI processing
            setTimeout(() => {
                generateSolution(problemText || 'Uploaded image problem');
                document.getElementById('loadingOverlay').style.display = 'none';
                document.getElementById('solutionSection').style.display = 'block';
                
                // Scroll to solution
                document.getElementById('solutionSection').scrollIntoView({ 
                    behavior: 'smooth' 
                });
                
                // Update stats
                updateStats();
            }, 3000);
        }
        
        // Solution generation
        function generateSolution(problem) {
            const solutions = {
                algebra: {
                    steps: [
                        { title: "Identify the equation", content: "We have: 3x + 7 = 2x - 5" },
                        { title: "Move variables to one side", content: "3x - 2x = -5 - 7" },
                        { title: "Simplify", content: "x = -12" },
                        { title: "Check the solution", content: "3(-12) + 7 = -36 + 7 = -29<br>2(-12) - 5 = -24 - 5 = -29 ‚úì" }
                    ],
                    explanation: "This is a linear equation in one variable. We use the principle of equality: what we do to one side, we must do to the other. By collecting like terms and isolating x, we find the solution."
                },
                geometry: {
                    steps: [
                        { title: "Identify given information", content: "Diameter = 10 cm, so radius = 5 cm" },
                        { title: "Recall the formula", content: "Area of circle = œÄr¬≤" },
                        { title: "Substitute values", content: "A = œÄ √ó 5¬≤ = œÄ √ó 25" },
                        { title: "Calculate final answer", content: "A = 25œÄ ‚âà 78.54 cm¬≤" }
                    ],
                    explanation: "The area of a circle depends on its radius squared. Since area grows with the square of the radius, small increases in radius create large increases in area."
                },
                default: {
                    steps: [
                        { title: "Problem Analysis", content: `Analyzing: "${problem.substring(0, 50)}..."` },
                        { title: "Apply Mathematical Principles", content: "Using appropriate formulas and theorems" },
                        { title: "Step-by-step Calculation", content: "Working through each step systematically" },
                        { title: "Verify Solution", content: "Checking our answer makes sense" }
                    ],
                    explanation: "Every math problem can be solved by breaking it down into smaller, manageable steps. The key is to identify what type of problem it is and apply the right mathematical tools."
                }
            };
            
            let solutionData;
            if (problem.includes('3x + 7 = 2x - 5')) {
                solutionData = solutions.algebra;
            } else if (problem.includes('area of a circle')) {
                solutionData = solutions.geometry;
            } else {
                solutionData = solutions.default;
            }
            
            // Populate solution steps
            const stepsContainer = document.getElementById('solutionSteps');
            stepsContainer.innerHTML = '';
            
            solutionData.steps.forEach((step, index) => {
                const stepDiv = document.createElement('div');
                stepDiv.className = 'step';
                stepDiv.innerHTML = `
                    <div class="step-number">Step ${index + 1}: ${step.title}</div>
                    <div class="step-content">${step.content}</div>
                `;
                stepsContainer.appendChild(stepDiv);
            });
            
            // Populate explanation
            document.getElementById('explanationContent').innerHTML = solutionData.explanation;
        }
        
        // Load recent problems
        function loadRecentProblem(type) {
            const problems = {
                quadratic: "x¬≤ - 5x + 6 = 0",
                derivative: "Find the derivative of f(x) = sin(x) + cos(x)",
                geometry: "Find the area of a triangle with sides 3, 4, and 5",
                statistics: "Calculate the mean and standard deviation of: 2, 4, 6, 8, 10"
            };
            
            document.getElementById('problemText').value = problems[type];
            setInputMethod('text');
            
            // Auto-scroll to input
            document.querySelector('.homework-input-section').scrollIntoView({ 
                behavior: 'smooth' 
            });
        }
        
        // Rating system
        function rateSolution(rating) {
            const messages = {
                helpful: "Thanks for the feedback! üëç",
                confusing: "We'll work on making explanations clearer! ü§î",
            };
            
            alert(messages[rating]);
        }
        
        function getMoreHelp() {
            alert(`üÜò Need more help?\n\n‚Ä¢ Join our study groups\n‚Ä¢ Book a 1-on-1 tutor session\n‚Ä¢ Check our video library\n‚Ä¢ Ask in the community forum`);
        }
        
        // Update statistics
        function updateStats() {
            const stats = {
                problemsSolved: parseInt(document.getElementById('problemsSolved').textContent) + 1,
                avgSolveTime: (Math.random() * 2 + 1).toFixed(1) + 'min',
                helpfulRating: (Math.random() * 0.5 + 4.5).toFixed(1) + '/5',
                streak: parseInt(document.getElementById('streak').textContent)
            };
            
            document.getElementById('problemsSolved').textContent = stats.problemsSolved;
            document.getElementById('avgSolveTime').textContent = stats.avgSolveTime;
            document.getElementById('helpfulRating').textContent = stats.helpfulRating;
        }
        
        // Real-time stats updates - OPTIMIZED
        function updateRealTimeStats() {
            const elements = ['problemsSolved', 'streak'];
            elements.forEach(id => {
                const element = document.getElementById(id);
                if (element && Math.random() < 0.02) { // Reduced from 5% to 2% chance
                    // Use CSS class instead of direct style manipulation for better performance
                    element.classList.add('pulse-animation');
                    setTimeout(() => {
                        element.classList.remove('pulse-animation');
                    }, 500);
                }
            });
        }
        
        // Initialize page - OPTIMIZED FOR SPEED
        document.addEventListener('DOMContentLoaded', function() {
            // Fast initialization
            initializePage();
        });
        
        function initializePage() {
            // Check subscription status efficiently
            const subscriptionPlan = localStorage.getItem('subscriptionPlan') || 'free';
            
            if (subscriptionPlan === 'free') {
                // Add usage limit for free users
                const solveBtn = document.querySelector('.solve-btn');
                if (solveBtn) {
                    solveBtn.innerHTML = '<i class="fas fa-magic"></i> Solve Problem (4/5 daily uses)';
                }
            }
            
            // Start real-time updates with longer interval to reduce CPU usage
            setTimeout(() => {
                setInterval(updateRealTimeStats, 30000); // Reduced from 10s to 30s
            }, 2000);
        }
        
        // Add pulse animation class - OPTIMIZED
        const style = document.createElement('style');
        style.textContent = `
            @keyframes pulse {
                0% { transform: scale(1); }
                50% { transform: scale(1.05); }
                100% { transform: scale(1); }
            }
            
            .pulse-animation {
                animation: pulse 0.5s ease;
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
